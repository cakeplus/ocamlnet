----------------------------------------------------------------------
Plan for Ocamlnet 3
----------------------------------------------------------------------

- Focus RPC:
  * Rpc_server: Allow to set timeout for the server response itself
    (self-watching)
  * Annotations
  * Doc: Tutorial for Rpc_proxy. Upgrade one example.

- Netlog:

  Modules to look through:
  - Rpc_client DONE
  - Rpc_server DONE
  - netplex: redirect DONE
  - Netplex_log.debug_* DONE
  - netplex debug messages DONE
  - Equeue DONE
  - Unixqueue_select DONE
  - Unixqueue_util DONE

  - Uq_gtk
  - Uq_tcl
  - netcgi2 Netcgi_ajp
  - netcgi2 Netcgi_common
  - netcgi2 Netcgi_scgi
  - netclient
  - nethttpd_engine


- Focus Win32:

  * Documentation: What is supported on Win32?

  + Open:
    - Shell: search executables

  Bugs:
  - examples/rpc/finder: Investigate why not all handles are closed
    ("register_proxy: keeping 20/43 entries in proxy tbl")

- Focus Netplex:
  * Netplex_control_routine:
    Use plugin mechanism to run ad-hoc defined routines in controller
    context.

    define_control_routines
      ["foo", (foo : string array -> string array); ... ]

    let [| ... |] = call_control_routine "foo" [| ... |]

  * netplex_main:
      - set logger earlier (if external logger is used)
      - chdir for daemonize

  * Rpc_netplex: config var for Rpc_server.set_timeout

  * RPc_netplex:
      - "netplex.activations": Print all activations at a certain time
        (also for nethttpd?)


- NetCGI cleanup
  * remove netcgi1
  * cgi = alias for netcgi2
  * remove nethttpd-for-netcgi1, and fix types in nethttpd_for_netcgi2

- Bug fixes:
  * netcgi2, url: better magic to enfore '/' between script name and path info
  * nethtml: <body> should have ANY as sub elements
  * netclient: parsing fails of URL
    http://host?param
  * netplex: socket directory is ignored for Unix domain sockets.
    relative UD sockets should be taken relative to socket dir
  * RPC: prevent that xid's can be reused
  * nethttpd+netcgi2: GET /file//path?p=1
    parameters like p are not recognized when there is "//" in path
  * netclient: Set "Host" header also for proxy requests
  * Shell for POSIX systems: fix the style how ocamlnet waits for 
    forked processes. The current solution does not work well for
    mt programs because it is undefined which thread gets the SIGCHLD.

- syslog:
  * "syslog": Just calls syslog()
  * "syslog_emulation": The syslog protocol itself

- fd leaks / double close:
  * do something about this

- Other
  * Nethttpd: configurable error response
  * Nethttpd: suppress "broken pipe"
  * Check $Id$
  * Go through examples. Fix programming style
  * Gprof support (as for Wink)
  * Log of deprecated functions (Netlog). Enabled by default.

--- Already done:

  * Rpc_proxy: layer on top of Rpc_client w/ automatic connection handling
  * Generate proxies
  * Rpc trace
  * Fix: `Accept_limit_length for Rpc_server. Add filters to clients, too
    (see msg by rafaelsen on ocamlnet-devel)
  * Bug Paolo Donadeo on ocamlnet-devel:
    `Redirect_response not working
  * Redesign Win32 named pipe support. Interface resembles socket API.
  * Security aspects of Win32 named pipes
  * Fully integrate named pipes into Unixqueue and Netplex
  * Limited support for anonymous pipes using helper threads
    (Netsys_win32: I/O threads; also support these whereever reasonable)
  * Support for something similar to Netsys_posix.spawn
  * Integrate win32 spawn into Shell

- Shell_uq/Shell_sys: Drop Shell_sys.wait implementation. Replace with
  engine. The system_handler is replaced by something like
  type system_handler = {
     mutable eng_opt : engine opt;
       (* The engine. abort stops it. run runs it *)
     watch_descriptors : Unix.file_descr list -> Unix.file_descr list -> unit
       (* Set the descriptors to watch *)
  }


----------------------------------------------------------------------
Performance improvements after Ocamlnet 3.0
----------------------------------------------------------------------

A list of possible improvements, once interfaces are stable again:

- Provide epoll/kqueue-based event_system

- Implement Netplex_semaphore with POSIX semaphores for systems
  supporting them

- Implement Netplex_sharedvar with Netshm shared memory for systems
  supporting that

- Implement Netsys_posix.spawn with posix_spawn for systems 
  supporting that

- Improve Rtypes performance

- RPC: generate direct mapping

----------------------------------------------------------------------
Implementation improvements after Ocamlnet 3.0
----------------------------------------------------------------------

- Name_resulution_error
- Configurable async name resolution

- Cluster Message bus

- Netdate: support for newer RFC date formats

- Fix netplex + nethttpd + async API: netcgi cannot be used right now

- Netclient: Support for CONNECT

- access to good random number generator on all platforms
  (for cryptogrpahy)

- CHECK: GSSAPI, krb5 for rpc

----------------------------------------------------------------------
Old stuff, check first
----------------------------------------------------------------------

Equeue:
	- Fix command engines as commented in the code.

	- Uq_engines.connector: currently raises Not_found for a name
	  resolution error. Do something better.

	Syntax for engine concatenation?
   	- when_state style:
  	  eng1 >> (function Success _ -> | Error _ -> | ...)
	- ...

Netplex:
	- Move accepted() from Control to System? Implement totally different
	  mechanisms?

	- Bug: daemonization doesn't wait until the inner process is
	  initialized (enough)

Integration of new netcgi2
	- All the TODOs in Netcgi_common
	  Sched: after 2.2.0 is out

	- Move new cookie implementation to Nethttp, and make it a 
	  class
	  Sched: 2.3

	- Faster URL encoding functions can be moved to Netencoding
	  if really faster
	  Sched: 2.3

netcgi2-plex:
	- Implement mount_dir/mount_at
	  Sched: 2.3

RPC:
	- Exceptions from client callbacks are suppressed by default:
	  (1) Default handler re-raises exception
	  (2) Allow the handler to re-raise exception

Bugs Tidalwave:
  * ocamlnet
	- Bug: Netstring_pcre.global_replace
	  Sched: after 2.2.0 is out

	- Feature Netgzip hinzu
	  Sched: 2.3

Http_client.pipeline:
	- aggressive caching does not work properly. Sometimes descriptors
	  are closed in the wrong moment.
	  Sched: 2.3

Shell_uq:
	- Double close von stderr-Descriptor falls in when_done eine
          exception geworfen wird
